module.exports=function(e){var t={};function s(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,s),o.l=!0,o.exports}return s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},s.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=3)}([function(e,t){e.exports=require("axios")},function(e,t){e.exports=require("vue")},function(e,t){e.exports=require("clone")},function(e,t,s){"use strict";s.r(t);var i=s(0),o=s.n(i),r=s(2),c=s.n(r);function a(e,t){const s={};return e.forEach(e=>s[e[t]]=e),s}var n={instantiateMany:function(e,t){return e.map(e=>new t(e))},instantiateChilds:function(e){const t={};for(var s in e)t[s]=(i=e[s],Array.isArray(i)?i.map(e=>new x(e)):new x(i));var i;return t},clone:function(e){return c()(e)},mapById:function(e){return a(e,"id")},mapByUri:function(e){return a(e,"uri")},mapByTypeUri:function(e){return a(e,"typeUri")},forEach:function(e,t){for(var s in e)t(e[s])},filter:function(e,t){const s={};for(var i in e){const o=e[i];t(o)&&(s[i]=o)}return s},isEmpty:function(e){return!Object.keys(e).length},getCookie:function(e){const t=document.cookie.match(new RegExp(`\\b${e}=(\\w*)`));return t&&t[1]},setCookie:function(e,t){document.cookie=`${e}=${t};path=/`}},p={getTopic:(e,t,s)=>o.a.get(`/core/topic/${e}`,{params:{include_childs:t,include_assoc_childs:s}}).then(e=>new x(e.data)),getTopicsByType:e=>o.a.get(`/core/topic/by_type/${e}`).then(e=>n.instantiateMany(e.data,x)),getTopicRelatedTopics:(e,t)=>o.a.get(`/core/topic/${e}/related_topics`,{params:d(t)}).then(e=>n.instantiateMany(e.data,b)),searchTopics(e,t){const s={params:{search:e,field:t}};return o.a.get("/core/topic",s).then(e=>n.instantiateMany(e.data,x))},createTopic:e=>o.a.post("/core/topic",e).then(e=>new x(e.data)),updateTopic:e=>o.a.put(`/core/topic/${e.id}`,e).then(e=>e.data),deleteTopic:e=>o.a.delete(`/core/topic/${e}`).then(e=>e.data),getAssoc:(e,t,s)=>o.a.get(`/core/association/${e}`,{params:{include_childs:t,include_assoc_childs:s}}).then(e=>new I(e.data)),getAssocRelatedTopics:(e,t)=>o.a.get(`/core/association/${e}/related_topics`,{params:d(t)}).then(e=>n.instantiateMany(e.data,b)),createAssoc:e=>o.a.post("/core/association",e).then(e=>new I(e.data)),updateAssoc:e=>o.a.put(`/core/association/${e.id}`,e).then(e=>e.data),deleteAssoc:e=>o.a.delete(`/core/association/${e}`).then(e=>e.data),getAllTopicTypes:()=>o.a.get("/core/topictype/all").then(e=>n.instantiateMany(e.data,M)),createTopicType:e=>o.a.post("/core/topictype",e).then(e=>new M(e.data)),updateTopicType:e=>o.a.put("/core/topictype",e).then(e=>e.data),getAllAssocTypes:()=>o.a.get("/core/assoctype/all").then(e=>n.instantiateMany(e.data,D)),updateAssocType:e=>o.a.put("/core/assoctype",e).then(e=>e.data),getPlugins:()=>o.a.get("/core/plugin").then(e=>e.data),getWebsocketConfig:()=>o.a.get("/core/websockets").then(e=>e.data),createTopicmap:(e,t,s)=>o.a.post("/topicmap",void 0,{params:{name:e,renderer_uri:t,private:s}}).then(e=>new x(e.data)),getTopicmap:e=>o.a.get(`/topicmap/${e}`).then(e=>new R(e.data)),addTopicToTopicmap(e,t,s){h(s,"dm4.topicmaps.x","dm4.topicmaps.y"),o.a.post(`/topicmap/${e}/topic/${t}`,s)},addAssocToTopicmap(e,t,s){o.a.post(`/topicmap/${e}/association/${t}`,s)},addRelatedTopicToTopicmap(e,t,s,i){i?h(i,"dm4.topicmaps.x","dm4.topicmaps.y"):i={},o.a.post(`/topicmap/${e}/topic/${t}/association/${s}`,i)},setTopicViewProps(e,t,s){o.a.put(`/topicmap/${e}/topic/${t}`,s)},setAssocViewProps(e,t,s){o.a.put(`/topicmap/${e}/association/${t}`,s)},setTopicPosition(e,t,s){h(s,"x","y"),o.a.put(`/topicmap/${e}/topic/${t}/${s.x}/${s.y}`)},setTopicVisibility(e,t,s){o.a.put(`/topicmap/${e}/topic/${t}/${s}`)},removeAssocFromTopicmap(e,t){o.a.delete(`/topicmap/${e}/association/${t}`)},createWorkspace:(e,t,s)=>o.a.post("/workspace",void 0,{params:{name:e,uri:t,sharing_mode_uri:s}}).then(e=>e.data),getAssignedTopics:(e,t,s,i)=>o.a.get(`/workspace/${e}/topics/${t}`,{params:{include_childs:s,include_assoc_childs:i}}).then(e=>n.instantiateMany(e.data,x)),getAssignedWorkspace:e=>o.a.get(`/workspace/object/${e}`).then(e=>new x(e.data)),login:e=>o.a.post("/accesscontrol/login",void 0,{auth:e}),logout:()=>o.a.post("/accesscontrol/logout"),getUsername:()=>o.a.get("/accesscontrol/user").then(e=>e.data),getTopicPermissions:e=>o.a.get(`/accesscontrol/topic/${e}`).then(e=>e.data),getAssocPermissions:e=>o.a.get(`/accesscontrol/association/${e}`).then(e=>e.data),getXML:e=>o.a.get(e).then(e=>e.request.responseXML.documentElement),setErrorHandler(e){o.a.interceptors.response.use(e=>e,t=>(e(t),Promise.reject(t)))}};function d(e){return e&&{assoc_type_uri:e.assocTypeUri,my_role_type_uri:e.myRoleTypeUri,others_role_type_uri:e.othersRoleTypeUri,others_topic_type_uri:e.othersTopicTypeUri}}function h(e,t,s){e[t]=Math.round(e[t]),e[s]=Math.round(e[s])}var l=s(1),u=s.n(l);const y={topicTypes:void 0,assocTypes:void 0,dataTypes:void 0,roleTypes:void 0},T={putTopicType(e,t){w(t)},putAssocType(e,t){A(t)},_newTopicType(e,{topicType:t}){g(t)},_newAssocType(e,{assocType:t}){f(t)},_processDirectives(e,t){t.forEach(e=>{switch(e.type){case"UPDATE_TOPIC_TYPE":g(e.arg);break;case"DELETE_TOPIC_TYPE":console.warn("Directive DELETE_TOPIC_TYPE not yet implemented");break;case"UPDATE_ASSOCIATION_TYPE":f(e.arg);break;case"DELETE_ASSOCIATION_TYPE":console.warn("Directive DELETE_ASSOCIATION_TYPE not yet implemented")}})}};function m(e,t){return s=>{const i=y[e][s];if(!i)throw Error(`${t} "${s}" not found in type cache`);return i}}function g(e){w(new M(e))}function f(e){A(new D(e))}function w(e){if(!(e instanceof M))throw Error(e+" is not a TopicType");u.a.set(y.topicTypes,e.uri,e)}function A(e){if(!(e instanceof D))throw Error(e+" is not an AssocType");u.a.set(y.assocTypes,e.uri,e)}var v={init:function(e){return e.registerModule("typeCache",{state:y,actions:T}),Promise.all([p.getAllTopicTypes().then(e=>{y.topicTypes=n.mapByUri(e),w(new M({uri:"dm4.core.meta_meta_type",typeUri:"dm4.core.meta_meta_meta_type",value:"Meta Meta Type",dataTypeUri:"dm4.core.text",assocDefs:[],viewConfigTopics:[]}))}),p.getAllAssocTypes().then(e=>{y.assocTypes=n.mapByUri(e)}),p.getTopicsByType("dm4.core.data_type").then(e=>{y.dataTypes=n.mapByUri(e)}),p.getTopicsByType("dm4.core.role_type").then(e=>{y.roleTypes=n.mapByUri(e)})]).then(()=>{})},getTopicType:m("topicTypes","Topic type"),getAssocType:m("assocTypes","Assoc type"),getDataType:m("dataTypes","Data type"),getRoleType:m("roleTypes","Role type")},U={};function _(e,t){return(U[e]||(U[e]=t(e))).then(e=>e["dm4.accesscontrol.operation.write"])}var E={isTopicWritable:function(e){return _(e,p.getTopicPermissions)},isAssocWritable:function(e){return _(e,p.getAssocPermissions)},clear:function(){U={}}};const P="ï„Œ";class ${constructor(e){if("Object"!==e.constructor.name)throw Error(`DeepaMehtaObject constructor expects plain Object, got ${e.constructor.name} (${e})`);this.id=e.id,this.uri=e.uri,this.typeUri=e.typeUri,this.value=e.value,this.childs=n.instantiateChilds(e.childs)}get typeName(){return this.getType().value}getChildTopic(e){return this.childs[e]}fillChilds(){return this.getType().assocDefs.forEach(e=>{let t,s=this.childs[e.assocDefUri];s||(t=new x(e.getChildType().emptyInstance())),e.isOne()?(s?s.fillChilds():s=t,s.fillRelatingAssoc(e)):(s?s.forEach(e=>{e.fillChilds()}):s=[t],s.forEach(t=>{t.fillRelatingAssoc(e)})),t&&u.a.set(this.childs,e.assocDefUri,s)}),this}clone(){return n.clone(this)}}class x extends ${constructor(e){super(e),e.assoc&&(this.assoc=new I(e.assoc))}getType(){return v.getTopicType(this.typeUri)}isType(){return"dm4.core.topic_type"===this.typeUri||"dm4.core.assoc_type"===this.typeUri}getRelatedTopics(){return p.getTopicRelatedTopics(this.id)}update(){return console.log("update",this),p.updateTopic(this)}isWritable(){return E.isTopicWritable(this.id)}isTopic(){return!0}isAssoc(){return!1}newViewTopic(e){return new k({id:this.id,uri:this.uri,typeUri:this.typeUri,value:this.value,childs:{},viewProps:e})}asType(){if("dm4.core.topic_type"===this.typeUri)return v.getTopicType(this.uri);if("dm4.core.assoc_type"===this.typeUri)return v.getAssocType(this.uri);throw Error(`Not a type: ${this}`)}getIcon(){return this.getType().getIcon()||P}fillRelatingAssoc(e){this.assoc?this.assoc.fillChilds():this.assoc=new I(e.getInstanceLevelAssocType().emptyInstance())}}class I extends ${constructor(e){super(e),e.role1&&(this.role1=new C(e.role1)),e.role2&&(this.role2=new C(e.role2))}getRole(e){var t=this.role1.roleTypeUri===e,s=this.role2.roleTypeUri===e;if(t&&s)throw Error(`Both role types of association ${this.id} match ${e}`);return t?this.role1:s?this.role2:void 0}isTopicPlayer(e){return this.role1.topicId===e||this.role2.topicId===e}hasAssocPlayer(){return this.role1.hasAssocPlayer()||this.role2.hasAssocPlayer()}getType(){return v.getAssocType(this.typeUri)}isType(){return!1}getRelatedTopics(){return p.getAssocRelatedTopics(this.id)}update(){return console.log("update",this),p.updateAssoc(this)}isWritable(){return E.isAssocWritable(this.id)}isTopic(){return!1}isAssoc(){return!0}newViewAssoc(e){return new B({id:this.id,uri:this.uri,typeUri:this.typeUri,value:this.value,childs:{},role1:this.role1,role2:this.role2,viewProps:e})}}class C{constructor(e){this.topicId=e.topicId,this.topicUri=e.topicUri,this.assocId=e.assocId,this.roleTypeUri=e.roleTypeUri}getType(){return v.getRoleType(this.roleTypeUri)}get typeName(){return this.getType().value}hasAssocPlayer(){return this.assocId}getPlayer(){if(!this.topicId)throw Error(`Assoc role ${JSON.stringify(this)} has no topic player`);return p.getTopic(this.topicId)}}class b extends x{constructor(e){super(e),this.assoc=new I(e.assoc)}}class V extends x{constructor(e){super(e),this.dataTypeUri=e.dataTypeUri,this.indexModes=e.indexModeUris,this.assocDefs=n.instantiateMany(e.assocDefs,O),this.viewConfig=n.mapByTypeUri(n.instantiateMany(e.viewConfigTopics,x))}isSimple(){return["dm4.core.text","dm4.core.html","dm4.core.number","dm4.core.boolean"].includes(this.dataTypeUri)}isComposite(){return["dm4.core.value","dm4.core.identity"].includes(this.dataTypeUri)}getDataType(){return v.getDataType(this.dataTypeUri)}getViewConfig(e){const t=this.viewConfig["dm4.webclient.view_config"];if(!t)return;const s=t.childs[e];return s&&s.value}emptyInstance(){return{id:-1,uri:"",typeUri:this.uri,value:"",childs:(()=>{const e={};return this.assocDefs.forEach(t=>{const s=t.getChildType().emptyInstance();e[t.assocDefUri]=t.isOne()?s:[s]}),e})()}}toExternalForm(){const e=JSON.parse(JSON.stringify(this));return e.assocDefs.forEach(e=>{e.assocTypeUri=e.typeUri,delete e.typeUri}),console.log("toExternalForm",e),e}}class M extends V{newTopicModel(e){const t=function t(s){const i=v.getTopicType(s);if(i.isSimple())return{value:e};{const e=i.assocDefs[0],s=t(e.childTypeUri);return{childs:{[e.assocDefUri]:e.isOne()?s:[s]}}}}(this.uri);return t.typeUri=this.uri,t}getIcon(){return this.getViewConfig("dm4.webclient.icon")}update(){return p.updateTopicType(this.toExternalForm())}}class D extends V{getColor(){return this.getViewConfig("dm4.webclient.color")}update(){return p.updateAssocType(this.toExternalForm())}}class O extends I{constructor(e){super(e),this.parentCardinalityUri=e.parentCardinalityUri,this.childCardinalityUri=e.childCardinalityUri,this.viewConfig=n.mapByTypeUri(n.instantiateMany(e.viewConfigTopics,x)),this.parentTypeUri=this.getRole("dm4.core.parent_type").topicUri,this.childTypeUri=this.getRole("dm4.core.child_type").topicUri;const t=this.childs["dm4.core.assoc_type#dm4.core.custom_assoc_type"];this.customAssocTypeUri=t&&t.uri,this.assocDefUri=this.childTypeUri+(this.customAssocTypeUri?"#"+this.customAssocTypeUri:""),this.instanceLevelAssocTypeUri=this.customAssocTypeUri||this._defaultInstanceLevelAssocTypeUri();const s=this.childs["dm4.core.identity_attr"];this.isIdentityAttr=!!s&&s.value;const i=this.childs["dm4.core.include_in_label"];this.includeInLabel=!!i&&i.value}getChildType(){return v.getTopicType(this.childTypeUri)}getInstanceLevelAssocType(){return v.getAssocType(this.instanceLevelAssocTypeUri)}getCustomAssocType(){return this.customAssocTypeUri&&v.getAssocType(this.customAssocTypeUri)}isOne(){return"dm4.core.one"===this.childCardinalityUri}isMany(){return"dm4.core.many"===this.childCardinalityUri}getViewConfig(e){const t=this._getViewConfig(e);return t&&t.value}_getViewConfig(e){const t=this.viewConfig["dm4.webclient.view_config"];if(t)return t.childs[e]}_defaultInstanceLevelAssocTypeUri(){if("dm4.core.aggregation_def"===this.typeUri)return"dm4.core.aggregation";if("dm4.core.composition_def"===this.typeUri)return"dm4.core.composition";throw Error(`Unexpected association type URI: "${this.typeUri}"`)}emptyChildInstance(){const e=this.getChildType().emptyInstance();return e.assoc=this.getInstanceLevelAssocType().emptyInstance(),new x(e)}}class R extends x{constructor(e){super(e.info),this.topics=n.mapById(n.instantiateMany(e.topics,k)),this.assocs=n.mapById(n.instantiateMany(e.assocs,B))}getTopic(e){var t=this.getTopicIfExists(e);if(!t)throw Error(`Topic ${e} not found in topicmap ${this.id}`);return t}getTopicIfExists(e){return this.topics[e]}hasTopic(e){return this.getTopicIfExists(e)}getTopicViewProp(e,t){return this.getTopic(e).getViewProp(t)}setTopicViewProp(e,t,s){this.getTopic(e).setViewProp(t,s)}addTopic(e){if(!(e instanceof k))throw Error(`addTopic() expects a ViewTopic, got ${e.constructor.name}`);this.topics[e.id]=e}revealTopic(e,t){const s={},i=this.getTopicIfExists(e.id);if(i)i.isVisible()||(i.setVisibility(!0),s.type="show");else{const i={...t?{"dm4.topicmaps.x":t.x,"dm4.topicmaps.y":t.y}:void 0,"dm4.topicmaps.visibility":!0,"dm4.topicmaps.pinned":!1};this.addTopic(e.newViewTopic(i)),s.type="add",s.viewProps=i}return s}removeTopic(e){delete this.topics[e]}forEachTopic(e){n.forEach(this.topics,e)}getAssoc(e){var t=this.getAssocIfExists(e);if(!t)throw Error(`Assoc ${e} not found in topicmap ${this.id}`);return t}getAssocs(e){const t=[];return this.forEachAssoc(s=>{s.isTopicPlayer(e)&&t.push(s)}),t}getAssocIfExists(e){return this.assocs[e]}hasAssoc(e){return this.getAssocIfExists(e)}getAssocViewProp(e,t){return this.getAssoc(e).getViewProp(t)}setAssocViewProp(e,t,s){this.getAssoc(e).setViewProp(t,s)}addAssoc(e){if(!(e instanceof B))throw Error(`addAssoc() expects a ViewAssoc, got ${e.constructor.name}`);this.assocs[e.id]=e}revealAssoc(e){const t={};if(!this.getAssocIfExists(e.id)){const s={"dm4.topicmaps.pinned":!1};this.addAssoc(e.newViewAssoc(s)),t.type="add",t.viewProps=s}return t}removeAssoc(e){delete this.assocs[e]}removeAssocs(e){this.getAssocs(e).forEach(e=>{this.removeAssoc(e.id)})}forEachAssoc(e){n.forEach(this.assocs,e)}}class k extends x{constructor(e){super(e),this.viewProps=e.viewProps}getPosition(){return{x:this.getViewProp("dm4.topicmaps.x"),y:this.getViewProp("dm4.topicmaps.y")}}isVisible(){return this.getViewProp("dm4.topicmaps.visibility")}setPosition(e){this.setViewProp("dm4.topicmaps.x",e.x),this.setViewProp("dm4.topicmaps.y",e.y)}setVisibility(e){this.setViewProp("dm4.topicmaps.visibility",e)}getViewProp(e){return this.viewProps[e]}setViewProp(e,t){u.a.set(this.viewProps,e,t)}fetchObject(){return p.getTopic(this.id,!0,!0)}}class B extends I{constructor(e){super(e),this.viewProps=e.viewProps}getViewProp(e){return this.viewProps[e]}setViewProp(e,t){u.a.set(this.viewProps,e,t)}fetchObject(){return p.getAssoc(this.id,!0,!0)}}t.default={DeepaMehtaObject:$,Topic:x,Assoc:I,AssocRole:C,RelatedTopic:b,Type:V,TopicType:M,AssocType:D,Topicmap:R,ViewTopic:k,ViewAssoc:B,restClient:p,permCache:E,utils:n,init:e=>(p.setErrorHandler(e.onHttpError),v.init(e.store))}}]);